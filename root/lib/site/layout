[% # -*- mode: web; -*- %]
[% IF c.user %]  
[% PROCESS site/header %]

<div class="wrapper"> <!-- APP BODY -->

  [% PROCESS site/sidebar %]

    <noscript>
      <div class="panel panel-danger text-center">
	<div class="panel-heading">
	  <span class="fa fa-exclamation-triangle fa-lg"></span>
	  <strong>Warning! JavaScript is disabled!</strong>
	</div>
	<div class="panel-body">
	  Important functionality is missing! You are strongly recommended to enable JS!
	</div>
      </div>
    </noscript>
    <div class="container-fluid mb-3" id="workingfield">
      [% END %]
      
      [% content %]
      
      [% IF c.user %]  

    </div>

  [% PROCESS site/aside %]
  
</div> <!-- APP BODY -->

[% # PROCESS site/footer %]

<script src="/static/js/vue.js"></script>

<script src="/static/js/nprogress.js"></script>   

<script src="/static/js/umi-core-ajax.js"></script>   
<script src="/static/js/umi-header.js"></script>
<script src="/static/js/umi-searchby-modals.js"></script>

<script src="/static/js/jquery.datetimepicker.js"></script>

<script src="/static/js/jquery.quicksearch.js"></script>
<script src="/static/js/jquery.multi-select.js"></script>
<!-- <script src="/static/js/umi-multiselect.js"></script> -->


<!-- LDAP tree related (Vue based) -->
<script type="text/x-template" id="template-tree-item">
  <li class="tree-item" :class="{opened: opened, closed: !opened}">
 <div class="tree-point"
      :class="{'last-item':!(item.branch > 0 && !loading || item.branch > 0 || item.branch > 0)}">
      
      <div class="tree-item-options">
	
	<div class="tree-item-status" 
	     v-if="item.branch > 0 && !loading"
	     @click="toggleBranches">
	  <i class="text-white-50 fas fa-folder" aria-hidden="true" v-if="!opened"></i>
	  <i class="text-light fas fa-folder-open" aria-hidden="true" v-if="opened"></i>
	</div>
	
	<div class="tree-subitem-loader" v-if="loading"><!-- v-if="loading" -->
	  <i class="text-white-50 fas fa-circle-notch fa-pulse fa-fw margin-bottom"></i>
	</div>

	<span class="tree-item-link-list" 
	      @click="showItemBranches()"
	      v-if="item.branch > 0" 
	      title="Show sub items">
	  <i class="text-white-50 fas fa-layer-group fa-xs" aria-hidden="true"></i>
	</span>
	
	<i class="text-white-50 fas fa-sync fa-xs" aria-hidden="true"
	   title="Reload sub items"
	   v-if="item.branch > 0" 
	   @click="loadBranches()">
	</i>
	
      </div>

 <i class="fas fa-ellipsis-h text-success tree-item-leaf"
    v-if="!(item.branch > 0 && !loading || item.branch > 0 || item.branch > 0)"></i>

 <a class="text-light tree-item-link"
    @click="showItem()">{{ item.id }}</a>
 

 </div>

    <div class="tree-subitem">
      <ul v-if="branches.length" class="tree" :class="{opened: opened, closed: !opened}">
	<tree-item :item="item" 
		   v-for="(item, index) in branches" 
		   key="subtree.index">
	</tree-item>
      </ul>
    </div>
  </li>
</script>

<script type="text/x-template" id="template-tree">
  <div class="tree-container mono-only umi-text-xs">
    <ul class="tree-root tree">
      <tree-item
	v-for="(item, index) in tree" 
	:item="item" 
        :key="item.dn">
      </tree-item>
    </ul>
  </div>
</script>


<script src="/static/js/app/service/store.js"></script>
<script src="/static/js/app/service/api.js"></script>
<script src="/static/js/app/component/tree-item.component.js"></script>
<script src="/static/js/app/component/tree.component.js"></script>
<script src="/static/js/app/app.js"></script>

[% END %]
